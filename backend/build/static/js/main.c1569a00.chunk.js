(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{125:function(e,t,a){"use strict";a.r(t);var c=a(0),s=a(9),n=a.n(s),i=(a(87),a(141)),l=a(143),r=a(154),o=a(144),d=a(145),j=a(21),b=(a(93),a(2)),u=function(){var e=Object(j.b)().loginWithRedirect;return Object(b.jsxs)(i.a,{elevation:0,className:"card",children:[Object(b.jsxs)(l.a,{className:"card-content",children:[Object(b.jsx)(r.a,{"aria-label":"recipe",className:"appLogo",children:"IS"}),Object(b.jsx)(o.a,{variant:"h4",className:"heading",children:"InstaChat"}),Object(b.jsxs)(o.a,{className:"text",children:["Welcome to Instachat.",Object(b.jsx)("br",{})," Please login or Sign up below"]})]}),Object(b.jsx)(d.a,{variant:"contained",className:"loginBtn",disableElevation:!0,onClick:e,children:"LOGIN | SIGNUP"})]})},m=a(51),O=a(20),h=a(148),x=a(153),f=a(147),v=a(146),p=a(152),g=function(e){var t=Object(c.useState)(null),a=Object(O.a)(t,2),s=a[0],n=a[1],i=function(){n(null)},l=Boolean(s),d=l?"simple-popover":void 0;return Object(b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(b.jsxs)(x.a,{onClick:function(){e.onClick()},className:"users-list-item",children:[Object(b.jsx)(r.a,{alt:e.email,src:e.photo}),Object(b.jsxs)(x.a,{style:{width:"90%"},children:[Object(b.jsx)(o.a,{className:"user-name",children:e.email}),Object(b.jsxs)(x.a,{className:"status",children:[Object(b.jsxs)(x.a,{className:"status-indicator",children:[Object(b.jsx)(x.a,{className:"indicator",style:{backgroundColor:"online"===e.status?"rgb(39, 206, 39)":"#f17438"}}),Object(b.jsx)(o.a,{className:"indicator-text",children:e.status})]}),e.newMessages>0?Object(b.jsx)(x.a,{className:"new-message-indicator",children:e.newMessages}):null]})]})]}),Object(b.jsx)(v.a,{onClick:function(t){var a;a=t,e.email,n(a.currentTarget)},children:Object(b.jsx)(f.a,{style:{color:"white"},children:"more_vert"})}),Object(b.jsx)(p.a,{id:d,open:l,anchorEl:s,onClose:i,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(b.jsx)(x.a,{p:2,onClick:function(){e.blockUnblockContact(),i()},style:{cursor:"pointer"},children:Object(b.jsx)(o.a,{children:e.blocked?"Unblock":"Block"})})})]})},N=(a(99),function(e){return Object(b.jsx)(x.a,{className:e.fromSender?"from-sender":"from-recipient",children:Object(b.jsxs)(x.a,{className:e.fromSender?"from-sender-box":"from-recipient-box",children:[Object(b.jsx)(o.a,{className:"msg-date",children:e.dateTime}),Object(b.jsx)(o.a,{className:"msg-text",children:e.message})]})})}),k=a(73),w=a.n(k)()("https://instachatapp001.herokuapp.com"),C=function(){var e=Object(j.b)(),t=e.user,a=e.logout,s=Object(c.useState)([]),n=Object(O.a)(s,2),u=n[0],v=n[1],p=Object(c.useState)(""),k=Object(O.a)(p,2),C=k[0],y=k[1],S=Object(c.useState)(-1),I=Object(O.a)(S,2),E=I[0],U=I[1],T=Object(c.useState)(""),M=Object(O.a)(T,2),_=M[0],B=M[1],P=Object(c.useState)([]),z=Object(O.a)(P,2),L=z[0],D=z[1],F=Object(c.useState)([]),G=Object(O.a)(F,2),A=G[0],J=G[1];Object(c.useEffect)((function(){var e={email:null===t||void 0===t?void 0:t.email,picture:null===t||void 0===t?void 0:t.picture,status:"online"};w.emit("user_online",e),w.on("users",(function(e){var a=e.findIndex((function(e){return e.email===(null===t||void 0===t?void 0:t.email)}));e.forEach((function(c){var s=e[a].blacklistedUsers.indexOf(c.email);if((c.blocked=s>-1,c.blacklistedUsers)&&c.blacklistedUsers.indexOf(null===t||void 0===t?void 0:t.email)>-1){var n=e.findIndex((function(e){return e.email===c.email}));n>-1&&e.splice(n,1)}}));var c=e.findIndex((function(e){return e.email===(null===t||void 0===t?void 0:t.email)}));e.splice(c,1),v(e)})),w.on("message_received",(function(e){J(e)}))}),[]),Object(c.useEffect)((function(){if(0===A.length)D(A);else if(C.indexOf(A[A.length-1].sender)>-1)D(A);else{var e=A[A.length-1].sender,t=u.findIndex((function(t){return t.email===e})),a=Object(m.a)(u);a[t].newMessages+=1,v(a)}}),[A]);var R=Object(c.useRef)(null);Object(c.useEffect)((function(){R.current.scrollTop=R.current.scrollHeight}),[L]);var W=function(e){if(e.preventDefault(),!(_.trim().length<1))if(u[E].blocked)alert("You blocked this contact");else{var a={message:_,sender:null===t||void 0===t?void 0:t.email,to:u[E].socketId,conversation:C};B(""),w.emit("send_message",a)}};return Object(b.jsx)(i.a,{elevation:0,className:"chat-box",children:Object(b.jsx)(l.a,{className:"chat-box-content",children:Object(b.jsxs)(h.a,{container:!0,direction:"row",className:"grid-container",children:[Object(b.jsxs)(h.a,{item:!0,xs:3,className:"left-pane",children:[Object(b.jsxs)(x.a,{className:"current-user",children:[Object(b.jsx)(r.a,{src:null===t||void 0===t?void 0:t.picture}),Object(b.jsx)(o.a,{className:"user-name",children:null===t||void 0===t?void 0:t.email})]}),Object(b.jsx)(x.a,{className:"users-title",children:Object(b.jsx)(o.a,{children:"Users"})}),Object(b.jsx)(x.a,{className:"users-list",children:u.map((function(e,a){return Object(b.jsx)("div",{children:"online"===e.status?Object(b.jsx)(g,{blockUnblockContact:function(){var a;a=e.email,w.emit("block_user",{user:null===t||void 0===t?void 0:t.email,contact:a})},blocked:e.blocked,onClick:function(){!function(e){U(e);var a=u[e].email+":"+(null===t||void 0===t?void 0:t.email);y(a),w.emit("get_conversations",a);var c=Object(m.a)(u);c[e].newMessages=0,v(c)}(a)},email:e.email,photo:e.picture,status:e.status,newMessages:e.newMessages},a):null},a)}))})]}),Object(b.jsxs)(h.a,{item:!0,xs:9,className:"right-pane",children:[Object(b.jsxs)(x.a,{className:"right-pane-top-bar",children:[""===C?Object(b.jsx)(x.a,{}):Object(b.jsxs)(x.a,{className:"top-bar-title",children:[Object(b.jsx)(r.a,{className:"avatar",src:u[E].picture,alt:"adolfokrah@gmail.com"}),Object(b.jsx)(o.a,{children:u[E].email})]}),Object(b.jsx)(d.a,{onClick:function(){w.emit("logout",t),a({returnTo:window.location.origin})},variant:"contained",style:{backgroundColor:"#4ed6f0",color:"white"},disableElevation:!0,children:"LOGOUT"})]}),Object(b.jsx)("div",{className:"chat-body",ref:R,children:""===C?Object(b.jsx)(o.a,{children:"Please select a contact to chat with"}):Object(b.jsx)(b.Fragment,{children:L.map((function(e,a){return Object(b.jsx)(N,{message:e.message,dateTime:e.dateTime,fromSender:e.sender===(null===t||void 0===t?void 0:t.email)},a)}))})}),Object(b.jsxs)("form",{className:"message-box",onSubmit:W,children:[Object(b.jsx)("input",{onChange:function(e){return B(e.target.value)},value:_,disabled:""===C,className:"text-input",type:"text",placeholder:"Type your message"}),Object(b.jsx)(d.a,{disableElevation:!0,className:"sendBtn",variant:"contained",color:"primary",endIcon:Object(b.jsx)(f.a,{children:"send"}),disabled:""===C,onClick:W,children:"SEND"})]})]})]})})})},y=a(149),S=function(){var e=Object(j.b)(),t=e.isAuthenticated;return e.isLoading?Object(b.jsx)("div",{className:"app",children:Object(b.jsx)(y.a,{})}):Object(b.jsx)("div",{className:"App",children:t?Object(b.jsx)(C,{}):Object(b.jsx)(u,{})})},I=a(150);n.a.render(Object(b.jsx)(j.a,{domain:"dev-oi19pymz.us.auth0.com",clientId:"bDoNg4YTNFzFQPvgK6mgge591O5tiOPZ",redirectUri:window.location.origin,children:Object(b.jsx)(I.a,{className:"app-container",children:Object(b.jsx)(S,{})})}),document.getElementById("root"))},87:function(e,t,a){},93:function(e,t,a){},99:function(e,t,a){}},[[125,1,2]]]);
//# sourceMappingURL=main.c1569a00.chunk.js.map